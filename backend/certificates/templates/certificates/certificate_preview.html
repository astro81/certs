<!-- certificates/templates/certificates/certificate_preview.html -->
{% extends 'admin_panel/base.html' %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Certificate Preview</h1>
        <div>
            <a href="{% url 'certificates:download_certificate' certificate.id %}"
               class="btn btn-primary">Download PDF</a>
            <a href="{% url 'certificates:certificate_list' %}"
               class="btn btn-secondary">Back to List</a>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h5 class="card-title mb-0">Certificate Details</h5>
        </div>
        <div class="card-body">
            <div class="row mb-4">
                <div class="col-md-6">
                    <strong>Certificate Number:</strong> {{ certificate.certificate_number }}
                </div>
                <div class="col-md-6">
                    <strong>Issued Date:</strong> {{ certificate.issued_date }}
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-6">
                    <strong>Student Name:</strong> {{ certificate.student.full_name }}
                </div>
                <div class="col-md-6">
                    <strong>Course:</strong> {{ certificate.student.get_course_name_display }}
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <strong>Duration:</strong> {{ certificate.student.course_duration }}
                </div>
                <div class="col-md-6">
                    <strong>Mode:</strong> {{ certificate.student.get_mode_of_learning_display }}
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Preview -->
    <div class="card mt-4">
        <div class="card-header">
            <h5 class="card-title mb-0">Certificate Preview</h5>
        </div>
        <div class="card-body">
            {% if certificate.certificate_file %}
            <div class="embed-responsive embed-responsive-16by9">
                <iframe src="{{ certificate.certificate_file.url }}#toolbar=0&view=FitH"
                        class="embed-responsive-item"
                        style="border: none; height: 600px;">
                </iframe>
            </div>
            {% else %}
            <div class="alert alert-warning">
                Certificate PDF not found.
                <a href="{% url 'certificates:regenerate_certificate' certificate.id %}"
                   class="alert-link">Regenerate Certificate</a>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Actions -->
    <div class="card mt-4">
        <div class="card-header">
            <h5 class="card-title mb-0">Actions</h5>
        </div>
        <div class="card-body">
            <div class="btn-group">
                <a href="{% url 'certificates:download_certificate' certificate.id %}"
                   class="btn btn-success">Download Certificate</a>
                <a href="{% url 'certificates:send_certificate_email' certificate.id %}"
                   class="btn btn-info">Resend Email</a>
                <a href="{% url 'certificates:regenerate_certificate' certificate.id %}"
                   class="btn btn-warning">Regenerate PDF</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

